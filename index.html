import { useState, useEffect, useRef } from "react";

// â”€â”€ Geo Utils â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function generateCode() {
  const c = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
  let a = "", b = "";
  for (let i = 0; i < 4; i++) { a += c[~~(Math.random() * c.length)]; b += c[~~(Math.random() * c.length)]; }
  return a + "-" + b;
}
function haverDist(a, b, c, d) {
  const R = 6371000, p1 = a * Math.PI / 180, p2 = c * Math.PI / 180;
  const dp = (c - a) * Math.PI / 180, dl = (d - b) * Math.PI / 180;
  const x = Math.sin(dp / 2) ** 2 + Math.cos(p1) * Math.cos(p2) * Math.sin(dl / 2) ** 2;
  return R * 2 * Math.atan2(Math.sqrt(x), Math.sqrt(1 - x));
}
function calcBear(a, b, c, d) {
  const dl = (d - b) * Math.PI / 180, p1 = a * Math.PI / 180, p2 = c * Math.PI / 180;
  return (Math.atan2(Math.sin(dl) * Math.cos(p2), Math.cos(p1) * Math.sin(p2) - Math.sin(p1) * Math.cos(p2) * Math.cos(dl)) * 180 / Math.PI + 360) % 360;
}
function destPt(lat, lon, brng, d) {
  const R = 6371000, Î´ = d / R, Î¸ = brng * Math.PI / 180, p1 = lat * Math.PI / 180, l1 = lon * Math.PI / 180;
  const p2 = Math.asin(Math.sin(p1) * Math.cos(Î´) + Math.cos(p1) * Math.sin(Î´) * Math.cos(Î¸));
  const l2 = l1 + Math.atan2(Math.sin(Î¸) * Math.sin(Î´) * Math.cos(p1), Math.cos(Î´) - Math.sin(p1) * Math.sin(p2));
  return [p2 * 180 / Math.PI, l2 * 180 / Math.PI];
}
function fmtDist(m) { return m < 1000 ? `${Math.round(m)}m` : `${(m / 1000).toFixed(2)}km`; }
function cardDir(b) { return ["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"][Math.round(b / 22.5) % 16]; }
function fmtTime(ms) {
  const h = ms / 3600000;
  if (h > 48) return `${Math.floor(h / 24)}d`;
  if (h > 1) return `${Math.floor(h)}h`;
  return `${Math.round(h * 60)}m`;
}

// â”€â”€ Constants â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const CATS = [
  { e: "ğŸ“", l: "General", c: "#f5a623" }, { e: "ğŸ‰", l: "Party", c: "#ff6bbd" },
  { e: "ğŸ•", l: "Food", c: "#ff8c42" },    { e: "âš ï¸", l: "Alert", c: "#ff4466" },
  { e: "ğŸ’", l: "Treasure", c: "#7fdbff" }, { e: "ğŸ ", l: "Home", c: "#77dd77" },
  { e: "ğŸš—", l: "Meet Up", c: "#aab8ff" }, { e: "ğŸ¯", l: "Target", c: "#ffdd44" },
];

// â”€â”€ Compass SVG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function CompassRose({ bearing, size = 200, showCardinals = true, label = null }) {
  const needleAngle = bearing ?? 0;
  return (
    <div style={{ position: "relative", width: size, height: size, filter: "drop-shadow(0 0 18px rgba(212,136,42,0.35))" }}>
      <svg width={size} height={size} viewBox="0 0 200 200">
        {/* Rings */}
        {[98, 88, 70].map((r, i) => (
          <circle key={i} cx="100" cy="100" r={r}
            fill="none" stroke={i === 0 ? "rgba(212,136,42,0.5)" : i === 1 ? "rgba(212,136,42,0.2)" : "rgba(212,136,42,0.1)"}
            strokeWidth={i === 0 ? 1.5 : 1} />
        ))}
        {/* Tick marks */}
        {Array.from({ length: 72 }).map((_, i) => {
          const angle = i * 5, rad = angle * Math.PI / 180;
          const isMajor = angle % 90 === 0, isMed = angle % 45 === 0, isSm = angle % 15 === 0;
          const r1 = 98, r2 = isMajor ? 82 : isMed ? 86 : isSm ? 89 : 93;
          return (
            <line key={i}
              x1={100 + r1 * Math.sin(rad)} y1={100 - r1 * Math.cos(rad)}
              x2={100 + r2 * Math.sin(rad)} y2={100 - r2 * Math.cos(rad)}
              stroke={isMajor ? "rgba(212,136,42,0.8)" : "rgba(212,136,42,0.3)"}
              strokeWidth={isMajor ? 1.5 : 0.8} />
          );
        })}
        {/* Cardinal labels */}
        {showCardinals && [["N", 0], ["E", 90], ["S", 180], ["W", 270]].map(([l, a]) => {
          const rad = a * Math.PI / 180, r = 75;
          return <text key={l} x={100 + r * Math.sin(rad)} y={100 - r * Math.cos(rad) + 4.5}
            textAnchor="middle" fill={l === "N" ? "#f5a623" : "rgba(212,136,42,0.6)"}
            fontSize="11" fontFamily="'Orbitron',monospace" fontWeight="700">{l}</text>;
        })}
        {/* Center dot */}
        <circle cx="100" cy="100" r="5" fill="#f5a623" opacity="0.9" />
        <circle cx="100" cy="100" r="2.5" fill="#fff" />
        {/* Needle */}
        <g transform={`rotate(${needleAngle} 100 100)`}>
          <polygon points="100,18 95,100 100,108 105,100" fill="#f5a623" opacity="0.95" />
          <polygon points="100,108 95,100 100,185 105,100" fill="#3a4a5a" />
          <polygon points="100,18 95,100 100,108 105,100" fill="none" stroke="rgba(255,220,150,0.5)" strokeWidth="0.5" />
        </g>
      </svg>
      {label && (
        <div style={{ position: "absolute", bottom: -28, width: "100%", textAlign: "center",
          fontFamily: "'Orbitron',monospace", fontSize: 11, color: "#f5a623", letterSpacing: 2 }}>
          {label}
        </div>
      )}
    </div>
  );
}

// â”€â”€ Navigation Arrow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function NavArrow({ angle, size = 220 }) {
  const hasAngle = angle != null;
  return (
    <div style={{ position: "relative", width: size, height: size }}>
      {/* Outer ring glow */}
      <div style={{
        position: "absolute", inset: 0, borderRadius: "50%",
        background: "radial-gradient(circle, rgba(245,166,35,0.08) 0%, transparent 70%)",
        border: "1px solid rgba(245,166,35,0.25)",
        animation: hasAngle ? "pulse 2s ease-in-out infinite" : "none"
      }} />
      <svg width={size} height={size} viewBox="0 0 220 220" style={{ filter: "drop-shadow(0 0 12px rgba(245,166,35,0.5))" }}>
        {/* Rings */}
        <circle cx="110" cy="110" r="105" fill="rgba(8,12,18,0.6)" stroke="rgba(245,166,35,0.3)" strokeWidth="1" />
        <circle cx="110" cy="110" r="80" fill="none" stroke="rgba(245,166,35,0.1)" strokeWidth="1" strokeDasharray="4 8" />
        {/* Cardinal dots */}
        {[0, 90, 180, 270].map(a => {
          const rad = a * Math.PI / 180;
          return <circle key={a} cx={110 + 95 * Math.sin(rad)} cy={110 - 95 * Math.cos(rad)} r="3"
            fill={a === 0 ? "#f5a623" : "rgba(245,166,35,0.3)"} />;
        })}
        {/* N label */}
        <text x="110" y="7" textAnchor="middle" fill="#f5a623" fontSize="10" fontFamily="'Orbitron',monospace">N</text>
        {/* Arrow */}
        {hasAngle ? (
          <g transform={`rotate(${angle} 110 110)`}>
            <polygon points="110,22 103,110 110,124 117,110" fill="#f5a623" />
            <polygon points="110,124 103,110 110,200 117,110" fill="rgba(200,150,50,0.3)" />
            <circle cx="110" cy="110" r="7" fill="#f5a623" />
            <circle cx="110" cy="110" r="3.5" fill="#fff" />
          </g>
        ) : (
          <>
            <circle cx="110" cy="110" r="10" fill="rgba(245,166,35,0.15)" stroke="rgba(245,166,35,0.4)" strokeWidth="1" />
            <text x="110" y="115" textAnchor="middle" fill="rgba(245,166,35,0.5)" fontSize="9" fontFamily="'Orbitron',monospace">?</text>
          </>
        )}
      </svg>
    </div>
  );
}

// â”€â”€ GPS Indicator â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function GpsChip({ gps }) {
  const acc = gps?.acc;
  const color = !gps ? "#666" : acc < 15 ? "#44dd88" : acc < 50 ? "#f5a623" : "#ff6644";
  const label = !gps ? "No GPS" : acc < 15 ? `Â±${acc}m âœ“` : acc < 50 ? `Â±${acc}m ~` : `Â±${acc}m âœ—`;
  return (
    <div style={{ display: "flex", alignItems: "center", gap: 5, fontSize: 11,
      fontFamily: "'Orbitron',monospace", color, opacity: 0.85 }}>
      <div style={{ width: 7, height: 7, borderRadius: "50%", background: color,
        boxShadow: `0 0 6px ${color}`, animation: gps ? "blink 1.5s ease-in-out infinite" : "none" }} />
      {label}
    </div>
  );
}

// â”€â”€ Main App â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
export default function App() {
  const [screen, setScreen] = useState("home");
  const [gps, setGps] = useState(null);
  const [devHead, setDevHead] = useState(null);

  // Create state
  const [cMode, setCMode] = useState("point");
  const [locked, setLocked] = useState(false);
  const [lockedBear, setLockedBear] = useState(0);
  const [distVal, setDistVal] = useState("100");
  const [distUnit, setDistUnit] = useState("m");
  const [msg, setMsg] = useState("");
  const [catIdx, setCatIdx] = useState(0);
  const [expHrs, setExpHrs] = useState("24");
  const [createdCode, setCreatedCode] = useState(null);
  const [saving, setSaving] = useState(false);
  const [copied, setCopied] = useState(false);

  // Navigate state
  const [codeInput, setCodeInput] = useState("");
  const [activePin, setActivePin] = useState(null);
  const [navErr, setNavErr] = useState("");
  const [navTarget, setNavTarget] = useState(null);
  const [alerted, setAlerted] = useState(false);
  const [arrived, setArrived] = useState(false);

  // My pins
  const [myPins, setMyPins] = useState([]);
  const [pinsLoaded, setPinsLoaded] = useState(false);

  // GPS
  useEffect(() => {
    if (!navigator.geolocation) return;
    const id = navigator.geolocation.watchPosition(
      p => setGps({ lat: p.coords.latitude, lon: p.coords.longitude, acc: Math.round(p.coords.accuracy) }),
      () => {}, { enableHighAccuracy: true, maximumAge: 3000, timeout: 15000 }
    );
    return () => navigator.geolocation.clearWatch(id);
  }, []);

  // Compass
  useEffect(() => {
    const h = e => {
      let v = null;
      if (e.webkitCompassHeading != null) v = e.webkitCompassHeading;
      else if (e.absolute && e.alpha != null) v = (360 - e.alpha + 360) % 360;
      else if (e.alpha != null) v = (360 - e.alpha + 360) % 360;
      if (v != null) setDevHead(Math.round(v));
    };
    window.addEventListener("deviceorientationabsolute", h, true);
    window.addEventListener("deviceorientation", h, true);
    return () => {
      window.removeEventListener("deviceorientationabsolute", h, true);
      window.removeEventListener("deviceorientation", h, true);
    };
  }, []);

  const currentBear = locked ? lockedBear : (devHead ?? 0);

  // Nav calc
  useEffect(() => {
    if (!activePin) return;
    if (activePin.mode === "here") setNavTarget({ lat: activePin.lat, lon: activePin.lon });
    else {
      const [lt, ln] = destPt(activePin.oLat, activePin.oLon, activePin.bear, activePin.distM);
      setNavTarget({ lat: lt, lon: ln });
    }
  }, [activePin]);

  const navBear = navTarget && gps ? calcBear(gps.lat, gps.lon, navTarget.lat, navTarget.lon) : null;
  const navDist = navTarget && gps ? haverDist(gps.lat, gps.lon, navTarget.lat, navTarget.lon) : null;
  const arrowAngle = navBear != null && devHead != null ? (navBear - devHead + 360) % 360 : navBear;

  // Proximity
  useEffect(() => {
    if (navDist == null) return;
    if (navDist < 25 && !alerted) {
      setAlerted(true);
      if (navigator.vibrate) navigator.vibrate([200, 100, 200, 100, 500]);
    }
    if (navDist < 8 && !arrived) {
      setArrived(true);
      if (navigator.vibrate) navigator.vibrate([500, 200, 500]);
    }
    if (navDist > 50) { setAlerted(false); setArrived(false); }
  }, [navDist]);

  const loadPins = async () => {
    try { const r = await window.storage.get("mypins"); if (r) setMyPins(JSON.parse(r.value)); } catch {}
    setPinsLoaded(true);
  };
  useEffect(() => { if (screen === "mypins" && !pinsLoaded) loadPins(); }, [screen]);

  const handleCreate = async () => {
    if (!gps) { alert("Waiting for GPS locationâ€¦"); return; }
    if (!msg.trim()) { alert("Please enter a message for this pin."); return; }
    setSaving(true);
    const mult = distUnit === "km" ? 1000 : distUnit === "mi" ? 1609.34 : 1;
    const distM = parseFloat(distVal || "100") * mult;
    const code = generateCode();
    const pin = { code, message: msg.trim(), cat: CATS[catIdx], expiresAt: Date.now() + parseFloat(expHrs || "24") * 3600000, createdAt: Date.now(), mode: cMode };
    if (cMode === "point") { pin.oLat = gps.lat; pin.oLon = gps.lon; pin.bear = currentBear; pin.distM = distM; }
    else { pin.lat = gps.lat; pin.lon = gps.lon; pin.acc = gps.acc; }
    try {
      await window.storage.set(`pin:${code}`, JSON.stringify(pin), true);
      let ps = [];
      try { const r = await window.storage.get("mypins"); if (r) ps = JSON.parse(r.value); } catch {}
      ps.unshift({ code, msg: msg.trim(), cat: CATS[catIdx], expiresAt: pin.expiresAt });
      await window.storage.set("mypins", JSON.stringify(ps));
      setMyPins(ps);
      setCreatedCode(code);
    } catch { alert("Storage error. Try again."); }
    setSaving(false);
  };

  const handleNav = async (overCode) => {
    const raw = (overCode || codeInput).toUpperCase().replace(/[^A-Z0-9]/g, "");
    const code = raw.length >= 8 ? raw.slice(0, 4) + "-" + raw.slice(4, 8) : raw;
    setNavErr("");
    try {
      const r = await window.storage.get(`pin:${code}`, true);
      if (!r) { setNavErr("Code not found. Check the code and try again."); return; }
      const pin = JSON.parse(r.value);
      if (pin.expiresAt < Date.now()) { setNavErr("This pin has expired."); return; }
      setActivePin(pin); setAlerted(false); setArrived(false); setScreen("navigate");
    } catch { setNavErr("Code not found. Check the code and try again."); }
  };

  const copy = async (txt) => {
    try { await navigator.clipboard.writeText(txt); } catch {}
    setCopied(true); setTimeout(() => setCopied(false), 2000);
  };

  const resetCreate = () => {
    setMsg(""); setCatIdx(0); setDistVal("100"); setDistUnit("m");
    setExpHrs("24"); setCMode("point"); setLocked(false); setCreatedCode(null); setCopied(false);
  };

  // â”€â”€ Shared styles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const s = {
    root: { minHeight: "100dvh", background: "#080b0f", color: "#e0d8c8", fontFamily: "'Rajdhani', sans-serif", fontSize: 16, overflowX: "hidden" },
    header: { padding: "16px 20px 12px", borderBottom: "1px solid rgba(212,136,42,0.15)", display: "flex", alignItems: "center", justifyContent: "space-between", background: "rgba(0,0,0,0.4)", backdropFilter: "blur(8px)", position: "sticky", top: 0, zIndex: 10 },
    logo: { fontFamily: "'Orbitron',monospace", fontSize: 18, color: "#f5a623", fontWeight: 900, letterSpacing: 3, textShadow: "0 0 20px rgba(245,166,35,0.5)" },
    tab: (active) => ({ padding: "8px 14px", borderRadius: 6, fontSize: 13, fontFamily: "'Rajdhani',sans-serif", fontWeight: 700, cursor: "pointer", letterSpacing: 1, background: active ? "rgba(245,166,35,0.18)" : "transparent", color: active ? "#f5a623" : "rgba(224,216,200,0.5)", border: "1px solid " + (active ? "rgba(245,166,35,0.4)" : "transparent"), transition: "all 0.2s" }),
    card: { background: "rgba(255,255,255,0.04)", border: "1px solid rgba(212,136,42,0.15)", borderRadius: 12, padding: 20 },
    label: { fontSize: 12, fontFamily: "'Orbitron',monospace", color: "rgba(212,136,42,0.7)", letterSpacing: 2, marginBottom: 6, textTransform: "uppercase" },
    input: { width: "100%", background: "rgba(255,255,255,0.05)", border: "1px solid rgba(212,136,42,0.25)", borderRadius: 8, padding: "10px 14px", color: "#e0d8c8", fontFamily: "'Rajdhani',sans-serif", fontSize: 16, outline: "none", boxSizing: "border-box" },
    btn: (variant = "primary") => ({
      padding: "12px 24px", borderRadius: 8, fontFamily: "'Rajdhani',sans-serif", fontWeight: 700, fontSize: 15, letterSpacing: 1.5,
      cursor: "pointer", border: "none", transition: "all 0.2s",
      background: variant === "primary" ? "linear-gradient(135deg,#d4882a,#f0a830)" : variant === "ghost" ? "transparent" : "rgba(255,255,255,0.06)",
      color: variant === "primary" ? "#080b0f" : "#e0d8c8",
      border: variant === "ghost" ? "1px solid rgba(212,136,42,0.3)" : "none",
      boxShadow: variant === "primary" ? "0 4px 20px rgba(212,136,42,0.3)" : "none",
    }),
    bigNum: { fontFamily: "'Orbitron',monospace", fontSize: 42, color: "#f5a623", fontWeight: 700, textShadow: "0 0 30px rgba(245,166,35,0.5)", letterSpacing: 2 },
    mono: { fontFamily: "'Orbitron',monospace" },
  };

  // â”€â”€ HOME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (screen === "home") return (
    <div style={s.root}>
      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;600;700&display=swap');
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        @keyframes pulse { 0%,100%{opacity:1}50%{opacity:0.5} }
        @keyframes blink { 0%,100%{opacity:1}50%{opacity:0.3} }
        @keyframes spin { from{transform:rotate(0)}to{transform:rotate(360deg)} }
        @keyframes fadeup { from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)} }
        @keyframes ripple { 0%{transform:scale(1);opacity:0.6}100%{transform:scale(2.5);opacity:0} }
        input::placeholder{color:rgba(224,216,200,0.3)}
        textarea::placeholder{color:rgba(224,216,200,0.3)}
        textarea{resize:none}
        ::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(212,136,42,0.3);border-radius:2px}
      `}</style>

      {/* Topographic background */}
      <div style={{ position: "fixed", inset: 0, opacity: 0.07, pointerEvents: "none", backgroundImage: "repeating-linear-gradient(0deg,transparent,transparent 39px,rgba(212,136,42,0.5) 40px),repeating-linear-gradient(90deg,transparent,transparent 39px,rgba(212,136,42,0.5) 40px)", backgroundSize: "40px 40px" }} />

      <header style={s.header}>
        <div style={s.logo}>â¬¡ POINTME</div>
        <GpsChip gps={gps} />
      </header>

      <div style={{ padding: "32px 20px 24px", maxWidth: 480, margin: "0 auto", animation: "fadeup 0.4s ease" }}>
        {/* Hero */}
        <div style={{ textAlign: "center", marginBottom: 36 }}>
          <div style={{ display: "flex", justifyContent: "center", marginBottom: 20 }}>
            <CompassRose bearing={devHead} size={160} />
          </div>
          <h1 style={{ fontFamily: "'Orbitron',monospace", fontSize: 13, color: "rgba(212,136,42,0.7)", letterSpacing: 4, margin: 0, marginBottom: 8 }}>COMPASS SHARING</h1>
          <p style={{ color: "rgba(224,216,200,0.5)", fontSize: 14, margin: 0, lineHeight: 1.6 }}>
            Point. Share a code. Your friends navigate to youâ€”from anywhere.
          </p>
          {devHead != null && (
            <div style={{ marginTop: 12, fontSize: 13, fontFamily: "'Orbitron',monospace", color: "rgba(212,136,42,0.6)" }}>
              {devHead}Â° {cardDir(devHead)}
            </div>
          )}
        </div>

        {/* Enter code */}
        <div style={{ ...s.card, marginBottom: 16 }}>
          <div style={s.label}>Enter Code</div>
          <div style={{ display: "flex", gap: 8 }}>
            <input style={{ ...s.input, flex: 1, letterSpacing: 3, fontFamily: "'Orbitron',monospace", fontSize: 14 }}
              placeholder="XXXX-XXXX" value={codeInput}
              onChange={e => setCodeInput(e.target.value.toUpperCase().slice(0, 9))}
              onKeyDown={e => e.key === "Enter" && handleNav()} />
            <button style={{ ...s.btn("primary"), padding: "10px 18px", whiteSpace: "nowrap" }} onClick={() => handleNav()}>GO â†’</button>
          </div>
          {navErr && <div style={{ color: "#ff6644", fontSize: 12, marginTop: 8, fontFamily: "'Orbitron',monospace" }}>{navErr}</div>}
        </div>

        <div style={{ display: "flex", gap: 10, marginBottom: 24 }}>
          <button style={{ ...s.btn("ghost"), flex: 1, textAlign: "center" }} onClick={() => { resetCreate(); setScreen("create"); }}>
            + CREATE PIN
          </button>
          <button style={{ ...s.btn("secondary"), flex: 1, textAlign: "center" }} onClick={() => setScreen("mypins")}>
            MY PINS
          </button>
        </div>

        {/* Feature pills */}
        <div style={{ display: "flex", flexWrap: "wrap", gap: 8 }}>
          {[["ğŸ§­","Point Direction","Bearing + distance pin"],["ğŸ“","Drop Here","Exact GPS location"],["â°","Auto-Expire","Pins expire after set time"],["ğŸ“³","Proximity Buzz","Vibrates when you arrive"]].map(([e, t, d]) => (
            <div key={t} style={{ background: "rgba(255,255,255,0.03)", border: "1px solid rgba(212,136,42,0.1)", borderRadius: 8, padding: "8px 12px", fontSize: 12 }}>
              <span style={{ marginRight: 6 }}>{e}</span>
              <span style={{ color: "#e0d8c8", fontWeight: 600 }}>{t}</span>
              <div style={{ color: "rgba(224,216,200,0.4)", fontSize: 11, marginTop: 2 }}>{d}</div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );

  // â”€â”€ CREATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (screen === "create") return (
    <div style={s.root}>
      <style>{`@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;600;700&display=swap');*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}@keyframes blink{0%,100%{opacity:1}50%{opacity:0.3}}@keyframes fadeup{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}input::placeholder{color:rgba(224,216,200,0.3)}textarea::placeholder{color:rgba(224,216,200,0.3)}textarea{resize:none}::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:rgba(212,136,42,0.3);border-radius:2px}`}</style>
      <div style={{ position: "fixed", inset: 0, opacity: 0.05, pointerEvents: "none", backgroundImage: "repeating-linear-gradient(0deg,transparent,transparent 39px,rgba(212,136,42,0.5) 40px),repeating-linear-gradient(90deg,transparent,transparent 39px,rgba(212,136,42,0.5) 40px)", backgroundSize: "40px 40px" }} />

      <header style={s.header}>
        <button style={{ background: "none", border: "none", color: "rgba(212,136,42,0.7)", cursor: "pointer", fontSize: 13, fontFamily: "'Orbitron',monospace", letterSpacing: 1 }} onClick={() => setScreen("home")}>â† BACK</button>
        <div style={s.logo}>CREATE PIN</div>
        <GpsChip gps={gps} />
      </header>

      {createdCode ? (
        // SUCCESS
        <div style={{ padding: "32px 20px", maxWidth: 480, margin: "0 auto", animation: "fadeup 0.3s ease" }}>
          <div style={{ textAlign: "center", marginBottom: 28 }}>
            <div style={{ fontSize: 48, marginBottom: 12 }}>âœ…</div>
            <div style={{ fontFamily: "'Orbitron',monospace", fontSize: 14, color: "#44dd88", letterSpacing: 3 }}>PIN CREATED!</div>
          </div>
          <div style={{ ...s.card, textAlign: "center", marginBottom: 16, border: "1px solid rgba(68,221,136,0.3)" }}>
            <div style={{ fontSize: 11, fontFamily: "'Orbitron',monospace", color: "rgba(68,221,136,0.7)", letterSpacing: 3, marginBottom: 12 }}>SHARE THIS CODE</div>
            <div style={{ fontFamily: "'Orbitron',monospace", fontSize: 36, color: "#f5a623", letterSpacing: 8, fontWeight: 900, textShadow: "0 0 30px rgba(245,166,35,0.5)", marginBottom: 16 }}>
              {createdCode}
            </div>
            <div style={{ fontSize: 12, color: "rgba(224,216,200,0.5)", marginBottom: 16 }}>
              {CATS[catIdx].e} {msg} Â· expires in {expHrs}h
            </div>
            <button style={{ ...s.btn("primary"), width: "100%" }} onClick={() => copy(createdCode)}>
              {copied ? "âœ“ COPIED!" : "COPY CODE"}
            </button>
          </div>
          <div style={{ display: "flex", gap: 10 }}>
            <button style={{ ...s.btn("ghost"), flex: 1 }} onClick={resetCreate}>+ NEW PIN</button>
            <button style={{ ...s.btn("secondary"), flex: 1 }} onClick={() => setScreen("home")}>HOME</button>
          </div>
        </div>
      ) : (
        <div style={{ padding: "20px 20px 32px", maxWidth: 480, margin: "0 auto", animation: "fadeup 0.3s ease" }}>
          {/* Mode selector */}
          <div style={{ ...s.card, marginBottom: 14 }}>
            <div style={s.label}>Pin Mode</div>
            <div style={{ display: "flex", gap: 8 }}>
              {[["point", "ğŸ§­", "Point Direction", "Bearing + distance (good for imprecise GPS)"],
                ["here", "ğŸ“", "Drop Here", "Exact GPS coordinates"]].map(([m, e, t, d]) => (
                <button key={m} onClick={() => setCMode(m)} style={{
                  flex: 1, padding: 12, borderRadius: 8, cursor: "pointer", textAlign: "left",
                  background: cMode === m ? "rgba(245,166,35,0.12)" : "rgba(255,255,255,0.03)",
                  border: "1px solid " + (cMode === m ? "rgba(245,166,35,0.5)" : "rgba(212,136,42,0.15)"),
                  color: "#e0d8c8", transition: "all 0.2s"
                }}>
                  <div style={{ fontSize: 18, marginBottom: 4 }}>{e}</div>
                  <div style={{ fontWeight: 700, fontSize: 13 }}>{t}</div>
                  <div style={{ fontSize: 11, color: "rgba(224,216,200,0.45)", lineHeight: 1.3, marginTop: 2 }}>{d}</div>
                </button>
              ))}
            </div>
          </div>

          {/* Compass (point mode) */}
          {cMode === "point" && (
            <div style={{ ...s.card, marginBottom: 14, textAlign: "center" }}>
              <div style={s.label}>Compass Direction</div>
              {devHead == null && (
                <div style={{ fontSize: 12, color: "#f5a623", marginBottom: 12, fontFamily: "'Orbitron',monospace" }}>
                  âš  Rotate device to calibrate compass
                </div>
              )}
              <div style={{ display: "flex", justifyContent: "center", marginBottom: 16 }}>
                <CompassRose bearing={locked ? lockedBear : devHead} size={160} label={`${locked ? lockedBear : (devHead ?? 0)}Â° ${cardDir(locked ? lockedBear : (devHead ?? 0))}`} />
              </div>
              <div style={{ display: "flex", gap: 8, justifyContent: "center" }}>
                <button style={{
                  ...s.btn(locked ? "primary" : "ghost"), fontSize: 13, padding: "10px 20px"
                }} onClick={() => {
                  if (!locked) { setLockedBear(devHead ?? 0); setLocked(true); }
                  else setLocked(false);
                }}>
                  {locked ? `ğŸ”’ LOCKED ${lockedBear}Â° ${cardDir(lockedBear)}` : "ğŸ”“ TAP TO LOCK"}
                </button>
              </div>
              <div style={{ fontSize: 11, color: "rgba(224,216,200,0.35)", marginTop: 8 }}>
                Point your phone in the desired direction, then tap to lock
              </div>
            </div>
          )}

          {/* Distance (point mode) */}
          {cMode === "point" && (
            <div style={{ ...s.card, marginBottom: 14 }}>
              <div style={s.label}>Approximate Distance</div>
              <div style={{ display: "flex", gap: 8 }}>
                <input style={{ ...s.input, flex: 1 }} type="number" placeholder="100"
                  value={distVal} onChange={e => setDistVal(e.target.value)} />
                <select style={{ ...s.input, width: "auto", cursor: "pointer", paddingRight: 8 }}
                  value={distUnit} onChange={e => setDistUnit(e.target.value)}>
                  <option value="m">m</option>
                  <option value="km">km</option>
                  <option value="mi">mi</option>
                </select>
              </div>
            </div>
          )}

          {/* GPS info (here mode) */}
          {cMode === "here" && (
            <div style={{ ...s.card, marginBottom: 14 }}>
              <div style={s.label}>Your Location</div>
              {gps ? (
                <>
                  <div style={{ fontFamily: "'Orbitron',monospace", fontSize: 12, color: "rgba(212,136,42,0.8)", marginBottom: 4 }}>
                    {gps.lat.toFixed(6)}, {gps.lon.toFixed(6)}
                  </div>
                  <GpsChip gps={gps} />
                  {gps.acc > 50 && (
                    <div style={{ marginTop: 8, padding: "8px 12px", background: "rgba(255,68,70,0.1)", border: "1px solid rgba(255,68,70,0.2)", borderRadius: 6, fontSize: 12, color: "#ff8866" }}>
                      âš  GPS accuracy is low (Â±{gps.acc}m). Try "Point Direction" mode instead for better results outdoors, or wait for better signal.
                    </div>
                  )}
                </>
              ) : (
                <div style={{ color: "rgba(224,216,200,0.4)", fontSize: 13 }}>Acquiring GPSâ€¦</div>
              )}
            </div>
          )}

          {/* Message */}
          <div style={{ ...s.card, marginBottom: 14 }}>
            <div style={s.label}>Message</div>
            <textarea style={{ ...s.input, height: 72 }} placeholder="e.g. I'm near the red tent, come find me!"
              value={msg} onChange={e => setMsg(e.target.value)} maxLength={120} />
            <div style={{ textAlign: "right", fontSize: 11, color: "rgba(224,216,200,0.3)", marginTop: 4 }}>{msg.length}/120</div>
          </div>

          {/* Category */}
          <div style={{ ...s.card, marginBottom: 14 }}>
            <div style={s.label}>Category</div>
            <div style={{ display: "flex", flexWrap: "wrap", gap: 6 }}>
              {CATS.map((cat, i) => (
                <button key={i} onClick={() => setCatIdx(i)} style={{
                  padding: "6px 10px", borderRadius: 20, cursor: "pointer", fontSize: 13, fontFamily: "'Rajdhani',sans-serif", fontWeight: 600,
                  background: catIdx === i ? `${cat.c}22` : "rgba(255,255,255,0.03)",
                  border: "1px solid " + (catIdx === i ? cat.c + "66" : "rgba(212,136,42,0.1)"),
                  color: catIdx === i ? cat.c : "rgba(224,216,200,0.5)", transition: "all 0.15s"
                }}>
                  {cat.e} {cat.l}
                </button>
              ))}
            </div>
          </div>

          {/* Expiry */}
          <div style={{ ...s.card, marginBottom: 20 }}>
            <div style={s.label}>Pin Expires In</div>
            <div style={{ display: "flex", gap: 8, flexWrap: "wrap" }}>
              {[["1", "1 hr"], ["6", "6 hrs"], ["24", "24 hrs"], ["72", "3 days"], ["168", "1 week"]].map(([v, l]) => (
                <button key={v} onClick={() => setExpHrs(v)} style={{
                  padding: "8px 14px", borderRadius: 6, cursor: "pointer", fontSize: 13, fontFamily: "'Orbitron',monospace",
                  background: expHrs === v ? "rgba(245,166,35,0.15)" : "rgba(255,255,255,0.03)",
                  border: "1px solid " + (expHrs === v ? "rgba(245,166,35,0.5)" : "rgba(212,136,42,0.12)"),
                  color: expHrs === v ? "#f5a623" : "rgba(224,216,200,0.5)", transition: "all 0.15s"
                }}>{l}</button>
              ))}
            </div>
          </div>

          <button style={{ ...s.btn("primary"), width: "100%", padding: 16, fontSize: 16 }}
            onClick={handleCreate} disabled={saving}>
            {saving ? "SAVINGâ€¦" : "CREATE & GET CODE"}
          </button>
        </div>
      )}
    </div>
  );

  // â”€â”€ NAVIGATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (screen === "navigate") return (
    <div style={s.root}>
      <style>{`@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;600;700&display=swap');*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}@keyframes blink{0%,100%{opacity:1}50%{opacity:0.3}}@keyframes fadeup{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes ripple{0%{transform:scale(1);opacity:0.6}100%{transform:scale(2.5);opacity:0}}`}</style>
      <div style={{ position: "fixed", inset: 0, opacity: 0.05, pointerEvents: "none", backgroundImage: "repeating-linear-gradient(0deg,transparent,transparent 39px,rgba(212,136,42,0.5) 40px),repeating-linear-gradient(90deg,transparent,transparent 39px,rgba(212,136,42,0.5) 40px)", backgroundSize: "40px 40px" }} />

      <header style={s.header}>
        <button style={{ background: "none", border: "none", color: "rgba(212,136,42,0.7)", cursor: "pointer", fontSize: 13, fontFamily: "'Orbitron',monospace", letterSpacing: 1 }}
          onClick={() => { setScreen("home"); setActivePin(null); setNavTarget(null); }}>â† BACK</button>
        <div style={s.logo}>NAVIGATE</div>
        <GpsChip gps={gps} />
      </header>

      <div style={{ padding: "20px 20px 32px", maxWidth: 480, margin: "0 auto", animation: "fadeup 0.3s ease" }}>
        {/* Pin info card */}
        {activePin && (
          <div style={{ ...s.card, marginBottom: 20, display: "flex", alignItems: "flex-start", gap: 12, border: `1px solid ${activePin.cat?.c}33` }}>
            <div style={{ fontSize: 28 }}>{activePin.cat?.e}</div>
            <div style={{ flex: 1 }}>
              <div style={{ fontWeight: 700, fontSize: 16, marginBottom: 4 }}>{activePin.message}</div>
              <div style={{ display: "flex", gap: 12, fontSize: 12, color: "rgba(224,216,200,0.5)" }}>
                <span style={{ fontFamily: "'Orbitron',monospace" }}>{activePin.code}</span>
                <span>Â·</span>
                <span>expires {fmtTime(activePin.expiresAt - Date.now())}</span>
              </div>
            </div>
          </div>
        )}

        {/* Arrived banner */}
        {arrived && (
          <div style={{ textAlign: "center", padding: "16px", marginBottom: 16, background: "rgba(68,221,136,0.1)", border: "1px solid rgba(68,221,136,0.4)", borderRadius: 12, animation: "fadeup 0.3s ease" }}>
            <div style={{ fontSize: 28, marginBottom: 6 }}>ğŸ¯</div>
            <div style={{ fontFamily: "'Orbitron',monospace", fontSize: 14, color: "#44dd88", letterSpacing: 2 }}>YOU'VE ARRIVED!</div>
          </div>
        )}

        {/* Main compass / arrow */}
        <div style={{ display: "flex", flexDirection: "column", alignItems: "center", marginBottom: 24 }}>
          <NavArrow angle={arrowAngle} size={220} />
          <div style={{ marginTop: 32, textAlign: "center" }}>
            {navDist != null ? (
              <>
                <div style={s.bigNum}>{fmtDist(navDist)}</div>
                <div style={{ fontSize: 13, fontFamily: "'Orbitron',monospace", color: "rgba(212,136,42,0.6)", marginTop: 6, letterSpacing: 2 }}>
                  {navBear != null ? `${Math.round(navBear)}Â° ${cardDir(navBear)}` : "CALCULATINGâ€¦"}
                </div>
              </>
            ) : (
              <div style={{ fontSize: 13, fontFamily: "'Orbitron',monospace", color: "rgba(224,216,200,0.4)" }}>
                {!gps ? "ACQUIRING GPSâ€¦" : "CALCULATINGâ€¦"}
              </div>
            )}
          </div>
        </div>

        {/* Stats row */}
        <div style={{ display: "flex", gap: 10, marginBottom: 16 }}>
          {[
            ["BEARING", navBear != null ? `${Math.round(navBear)}Â°` : "â€”", "#f5a623"],
            ["YOUR HDG", devHead != null ? `${devHead}Â°` : "â€”", "rgba(212,136,42,0.7)"],
            ["GPS ACC", gps ? `Â±${gps.acc}m` : "â€”", gps?.acc < 20 ? "#44dd88" : gps?.acc < 50 ? "#f5a623" : "#ff6644"],
          ].map(([l, v, c]) => (
            <div key={l} style={{ flex: 1, ...s.card, textAlign: "center", padding: 12 }}>
              <div style={{ fontSize: 9, fontFamily: "'Orbitron',monospace", color: "rgba(212,136,42,0.5)", letterSpacing: 2, marginBottom: 4 }}>{l}</div>
              <div style={{ fontFamily: "'Orbitron',monospace", fontSize: 16, color: c, fontWeight: 700 }}>{v}</div>
            </div>
          ))}
        </div>

        {/* Tip */}
        {devHead == null && (
          <div style={{ ...s.card, marginBottom: 12, background: "rgba(245,166,35,0.06)", border: "1px solid rgba(245,166,35,0.2)" }}>
            <div style={{ fontSize: 12, color: "rgba(245,166,35,0.8)" }}>
              ğŸ§­ <strong>Tip:</strong> Rotate your phone in a figure-8 pattern to calibrate the compass. The arrow will point toward the pin relative to where you're facing.
            </div>
          </div>
        )}

        {navDist != null && navDist < 25 && !arrived && (
          <div style={{ ...s.card, marginBottom: 12, background: "rgba(245,166,35,0.1)", border: "1px solid rgba(245,166,35,0.4)", textAlign: "center" }}>
            <div style={{ fontSize: 13, color: "#f5a623", fontFamily: "'Orbitron',monospace", letterSpacing: 1 }}>
              ğŸ“³ ALMOST THERE â€” {fmtDist(navDist)} away
            </div>
          </div>
        )}

        {activePin?.mode === "point" && gps && (
          <div style={{ fontSize: 11, color: "rgba(224,216,200,0.3)", textAlign: "center", fontFamily: "'Orbitron',monospace" }}>
            Target computed from {Math.round(haverDist(gps.lat, gps.lon, activePin.oLat, activePin.oLon))}m origin Â· {Math.round(activePin.bear)}Â° Â· {fmtDist(activePin.distM)}
          </div>
        )}
      </div>
    </div>
  );

  // â”€â”€ MY PINS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  if (screen === "mypins") return (
    <div style={s.root}>
      <style>{`@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;600;700&display=swap');*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}@keyframes blink{0%,100%{opacity:1}50%{opacity:0.3}}@keyframes fadeup{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}`}</style>
      <div style={{ position: "fixed", inset: 0, opacity: 0.05, pointerEvents: "none", backgroundImage: "repeating-linear-gradient(0deg,transparent,transparent 39px,rgba(212,136,42,0.5) 40px),repeating-linear-gradient(90deg,transparent,transparent 39px,rgba(212,136,42,0.5) 40px)", backgroundSize: "40px 40px" }} />

      <header style={s.header}>
        <button style={{ background: "none", border: "none", color: "rgba(212,136,42,0.7)", cursor: "pointer", fontSize: 13, fontFamily: "'Orbitron',monospace", letterSpacing: 1 }} onClick={() => setScreen("home")}>â† BACK</button>
        <div style={s.logo}>MY PINS</div>
        <GpsChip gps={gps} />
      </header>

      <div style={{ padding: "20px 20px 32px", maxWidth: 480, margin: "0 auto", animation: "fadeup 0.3s ease" }}>
        {!pinsLoaded ? (
          <div style={{ textAlign: "center", color: "rgba(224,216,200,0.4)", padding: 40, fontFamily: "'Orbitron',monospace", fontSize: 12 }}>LOADINGâ€¦</div>
        ) : myPins.length === 0 ? (
          <div style={{ textAlign: "center", padding: 60 }}>
            <div style={{ fontSize: 40, marginBottom: 16 }}>ğŸ“</div>
            <div style={{ fontFamily: "'Orbitron',monospace", fontSize: 12, color: "rgba(224,216,200,0.4)", letterSpacing: 2 }}>NO PINS YET</div>
            <div style={{ color: "rgba(224,216,200,0.3)", fontSize: 13, marginTop: 8 }}>Create your first pin to share with friends</div>
            <button style={{ ...s.btn("ghost"), marginTop: 20 }} onClick={() => { resetCreate(); setScreen("create"); }}>+ CREATE PIN</button>
          </div>
        ) : (
          <>
            <div style={{ marginBottom: 16, display: "flex", justifyContent: "space-between", alignItems: "center" }}>
              <div style={{ fontSize: 12, fontFamily: "'Orbitron',monospace", color: "rgba(212,136,42,0.5)" }}>{myPins.length} PIN{myPins.length !== 1 ? "S" : ""}</div>
              <button style={{ ...s.btn("ghost"), padding: "6px 14px", fontSize: 12 }} onClick={() => { resetCreate(); setScreen("create"); }}>+ NEW PIN</button>
            </div>
            <div style={{ display: "flex", flexDirection: "column", gap: 10 }}>
              {myPins.map((p) => {
                const expired = p.expiresAt < Date.now();
                const remaining = p.expiresAt - Date.now();
                return (
                  <div key={p.code} style={{
                    ...s.card, opacity: expired ? 0.45 : 1,
                    border: `1px solid ${expired ? "rgba(255,100,100,0.15)" : p.cat?.c + "33" || "rgba(212,136,42,0.15)"}`,
                    cursor: expired ? "default" : "pointer",
                    transition: "border 0.2s"
                  }}>
                    <div style={{ display: "flex", gap: 12, alignItems: "flex-start" }}>
                      <div style={{ fontSize: 24, marginTop: 2 }}>{p.cat?.e}</div>
                      <div style={{ flex: 1, minWidth: 0 }}>
                        <div style={{ fontWeight: 700, fontSize: 15, marginBottom: 4, whiteSpace: "nowrap", overflow: "hidden", textOverflow: "ellipsis" }}>{p.msg}</div>
                        <div style={{ fontFamily: "'Orbitron',monospace", fontSize: 14, color: "#f5a623", letterSpacing: 4, marginBottom: 6 }}>{p.code}</div>
                        <div style={{ fontSize: 12, color: expired ? "#ff6644" : "rgba(224,216,200,0.45)", fontFamily: "'Orbitron',monospace" }}>
                          {expired ? "EXPIRED" : `expires in ${fmtTime(remaining)}`}
                        </div>
                      </div>
                      {!expired && (
                        <button style={{ ...s.btn("ghost"), padding: "6px 12px", fontSize: 11, flexShrink: 0 }}
                          onClick={() => copy(p.code)}>
                          COPY
                        </button>
                      )}
                    </div>
                    {!expired && (
                      <button style={{ ...s.btn("primary"), width: "100%", marginTop: 10, padding: "10px", fontSize: 13 }}
                        onClick={() => handleNav(p.code)}>
                        NAVIGATE â†’
                      </button>
                    )}
                  </div>
                );
              })}
            </div>
          </>
        )}
      </div>
    </div>
  );

  return null;
}
